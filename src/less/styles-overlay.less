// Copyright (c) Microsoft Open Technologies, Inc.  All Rights Reserved. Licensed under the Apache License, Version 2.0. See License.txt in the project root for license information.
/*
AppBar/Flyout z-index values:
    1000 - AppBar/settings click-eating div
    1002 - AppBar
    1004 - Settings Flyout
    1006 - Flyout click-eating div
    1008 - Flyout
*/

@import "base.less";
@import "mixins.less";

.win-appbarclickeater {
    z-index: 1000;
    background-color: transparent;
    display: none;
    width: 110%;
    height: 110%;
    left: -5%;
    top: -5%;
    position: fixed;
    touch-action: none;
    outline: 1px solid Purple; /*Necessary to block passthrough over webviews*/
    -ms-high-contrast-adjust: none;
}

.win-flyoutmenuclickeater {
    z-index: 1006;
    background-color: transparent;
    display: none;
    width: 110%;
    height: 110%;
    left: -5%;
    top: -5%;
    position: fixed;
    touch-action: none;
    outline: 1px solid Lime; /*Necessary to block passthrough over webviews*/
    -ms-high-contrast-adjust: none;
}

/*
Command buttons.
*/
button.win-command {
    background: none;
    background-clip: border-box;
    height: auto;
    padding: 0;
    margin: 0;
    border: 1px dotted; /* reserve focus rect */
    min-width: 40px; 
    min-height: 48px; 
    text-align: center;
    font-size: 9pt;
    line-height: 16px;
    font-weight: normal;
    overflow: visible;
    /* Commands are lrtb */
    writing-mode: lr-tb;
    position: relative;
    z-index:0;
}

button {
    .RTL({
        writing-mode: rl-tb;
    });
}

button.win-command:focus {
    outline: none;
}


/*
Command button icons.
*/
.win-commandicon {
    display: inline-block;
    margin: 12px 21px; /* left/right margin: 22px = 1px focus rect + 21px. Affects margin-top of  button.win-command .win-label */
    min-width: 0;
    min-height: 0;
    padding: 0;
    /* Normal sizing */
    width: 24px;
    height: 24px;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    cursor: default;
    position: relative;
    outline:none;
}

.win-commandimage {
    /* Default font for glyphs. */
    font-family: "Segoe UI Command", "Symbols";
    letter-spacing: 0;
    /* Applications provide their own content, like &#xE0D5;. */
    vertical-align: middle;
    font-size: 19pt;
    margin: 0;
    line-height: 24px; /* line-height must match the content box height */
    background-position: 0 0;
    background-origin: border-box;
    display: inline-block;
    width: 24px;
    height: 24px;
    background-size: 96px 48px;
    outline: none;
}

.win-commandimage.win-commandglyph {
    position: absolute;
    left:-4px; /* offset for font-size:19pt */
}

/*
Offsets for sprite versions.
*/
html.win-hoverable button:enabled:hover .win-commandimage, button:active .win-commandimage {
    background-position: -24px 0;
}

button:enabled:hover:active .win-commandimage.win-commandimage {
    background-position: -48px 0;
}

// The "-ms-keyboard-active" pseudo is not always supported. When it is not supported
//   it will be treated as a CSS parse error and will throw out all rules in the current
//   CSS rule group. For this reason, never group it with other rules.
button:-ms-keyboard-active .win-commandimage {
    background-position: -48px 0;
}

button:disabled .win-commandimage,
button:disabled:active .win-commandimage {
    background-position: -72px 0;
}

/*
Offsets for sprite versions in selected state.
*/
button[aria-checked=true] .win-commandimage {
    background-position: 0 -24px;
}

html.win-hoverable button[aria-checked=true]:enabled:hover .win-commandimage,
button[aria-checked=true]:active .win-commandimage {
    background-position: -24px -24px;
}

button[aria-checked=true]:enabled:hover:active .win-commandimage.win-commandimage {
    background-position: -48px -24px;
}

button[aria-checked=true]:-ms-keyboard-active .win-commandimage {
    background-position: -48px -24px;
}

button[aria-checked=true]:disabled .win-commandimage,
button[aria-checked=true]:disabled:active .win-commandimage {
    background-position: -72px -24px;
}

/*
Command button labels.
*/
button.win-command .win-label {
    position: relative;
    line-height: 16px;
    display: block;
    max-width: 66px; /* 68px button, but allow for 2*1px for focus border on each side */
    margin-top: -10px; /* 2px = 12px margin-bottom of .win-commandicon  - 10px*/
    margin-bottom: 6px;
    padding:0;
    overflow: hidden;
    word-wrap: break-word;
    word-break: keep-all;
    outline: none;
}

/*
AppBarCommand separator types.
*/
hr.win-command {
    display: inline-block;
    padding: 0;
    margin: 12px 16px;
    width: 2px;
    height: 24px;
    border: 0;
    vertical-align: top;
}

/*
AppBarCommand content types.
*/
div.win-command {
    display: inline-block;
    min-width: 0;
    min-height: 0;
    padding: 9px 31px;
    border: 1px dotted; /* reserve focus rect */
    text-align: center;
    font-size: 9pt;
    line-height: 16px;
    font-weight: normal;
    vertical-align: top;
    /* Content Commands are lrtb */
    writing-mode: lr-tb;
    position: relative;
}

div.win-command {
    .RTL({
        writing-mode: rl-tb;
    });
}

div.win-command:focus {
    outline: none;
}

/*
AppBar
*/
.win-appbar {
    z-index: 1002;
    border-width: 0;
    width: 100%;
    height: auto;
    left: 0;
    position: fixed;
    position: -ms-device-fixed;
    min-height: 25px;

    &.win-appbar-hiding > :not(.win-appbar-invokebutton) {
        opacity: 0;
    }

    &.win-menulayout.win-appbar-hiding .win-appbar-menu {
        opacity: 1;
    }

    &.win-appbar-hidden > :not(.win-appbar-invokebutton) {
        display: none !important;
    }

    &.win-appbar-hiding .win-appbar-invokebutton,
    &.win-appbar-hidden .win-appbar-invokebutton {
        width: 100%;
    }

    .win-appbar-invokebutton {
        width: 60px;
        height: 40px;
        position: absolute;
        right: 0px;
        margin: 0px;
        padding: 0px;
        border: none;
        min-width: 0px;
        display: none;
        // Setting explicit z-index here works around draw ordering issue that occurs in IE when other positioned elements are present in a custom AppBar.
        z-index: 1;

        .win-appbar-ellipsis {
            width: 58px; /* 58px + 2px border = 60px */
            height: 23px; /* 23px + 2px of border === the height of the closed minimal AppBar.*/
            right: 0px;
            position: absolute;
            display: inline-block;
            border: dotted 1px;
            font-size: 19px;
            text-align: center;
            font-family: "Segoe UI Symbol", "Symbols";

            &::before {
                content: "\E10C";
                position: relative;
            }
        }

        &:focus .win-appbar-ellipsis {
            border: dotted 1px;
        }
    }

    .RTL({
        .win-appbar-invokebutton,
        .win-appbar-invokebutton .win-appbar-ellipsis {
            right: auto;
            left: 0px;
        }
    });

    &.win-bottom {
        .win-appbar-invokebutton,
        .win-appbar-ellipsis {
            top: 0px;
        }

        .win-appbar-ellipsis::before {
            /* Necessary to adjust vertical position of Ellipsis Glyph in bottom AppBar so that the top of the 3 ellipsis dots are drawn ~10px away from the top of the AppBar.
               This is to appear consistent with where the top of the win-commandicon element in an AppBarCommand button is drawn, also 10px away from the top of the AppBar.
               This value is dependant on the font-size of the Ellipsis Glyph being 19px and the height of the parent element being 21px */
            top: -3px;
        }
    }

    &.win-top {
        .win-appbar-invokebutton,
        .win-appbar-ellipsis {
            bottom: 0px;
        }

        .win-appbar-ellipsis::before {
            /* Necessary to adjust vertical position of Ellipsis Glyph in top AppBar so that the botom of the 3 ellipsis dots are drawn ~10px away from the bottom of the AppBar.
               This is to appear consistent with where the bottom of the win-label in an AppBarCommand button is drawn, also 10px away from the bottom of the AppBar.
               This value is dependant on the font-size of the Ellipsis Glyph being 19px and the height of the parent element being 21px */
            bottom: 2px;
        }
    }

    &.win-appbar-minimal .win-appbar-invokebutton {
            display: block;
    }
}

/*
AppBar commands layout
*/
.win-commandlayout {
    #flex > .display-flex();
    #flex > .flex-direction(row);
    #flex > .flex-wrap(nowrap);
    #flex > .justify-content(center);
    #flex > .align-items(flex-start);

    .win-primarygroup {
        #flex > .order(2);
        #flex > .display-inline-flex();
        #flex > .flex(1; 1; auto);
        #flex > .flex-direction(row);
        #flex > .flex-wrap(wrap);
        #flex > .justify-content(flex-end);
        #flex > .align-items(flex-start);
    }

    .win-secondarygroup {
        #flex > .order(1);
        #flex > .display-inline-flex();
        #flex > .flex(1; 1; auto);
        #flex > .flex-direction(row);
        #flex > .flex-wrap(wrap);
        #flex > .justify-content(flex-start);
        #flex > .align-items(flex-start);
    }

    .win-command {
        #flex > .flex(0; 0; auto);
    }

    &.win-appbar-showing,
    &.win-appbar-shown,
    &.win-appbar-hiding {
        min-height: 62px;
    }

    &.win-appbar-minimal {
        // Minimal AppBar with commands layout makes room for the invokeButton.
        padding-right: 60px;
        width: ~"calc(100% - 60px)";
    }
}

/* CommandsLayout RTL */
.win-commandlayout {
    .RTL({
        &.win-appbar-minimal {
            padding-right: 0px;
            padding-left: 60px;
        }
    });
}

/*
AppBar menu layout 
*/
.win-menulayout {
    .win-appbar-menu {
        position:absolute;
        right:0;
        top:0;

        .RTL({
            left: 0;
            right: auto;
        });
    }

    .win-appbar-toolbarcontainer {
        overflow: hidden;
    }

    &.win-bottom .win-appbar-toolbarcontainer {
        overflow:visible;
    }

    .win-toolbar {
        max-width:100vw;
    }
}

/*
High contrast AppBar needs a border
*/
@media (-ms-high-contrast) {
    /*
    AppBar Borders
    */
    .win-appbar {
        border: solid 2px;
    }

    .win-appbar.win-top {
        border-top: none;
        border-left: none;
        border-right: none;
    }

    .win-appbar.win-bottom {
        border-bottom: none;
        border-left: none;
        border-right: none;
    }

    .win-appbar.win-top button.win-command,
    .win-appbar.win-top div.win-command {
        padding-bottom: 7px; /* 7px - 2px smaller to account for the high-constrast appbar border */
    }

    .win-appbar.win-bottom button.win-command,
    .win-appbar.win-bottom div.win-command {
        padding-top: 7px; /* 7px - 2px smaller to account for the high-constrast appbar border */
    }

    .win-appbar.win-top hr.win-command {
        margin-bottom: 28px;
    }

    .win-appbar.win-bottom hr.win-command {
        margin-top: 8px;
    }

    .win-commandlayout {
        &.win-appbar-showing,
        &.win-appbar-shown,
        &.win-appbar-hiding {
            min-height: 62px;
        }
    }
}

/*
Flyout control.
*/
.win-flyout {
    z-index: 1008;
    position: fixed;
    position: -ms-device-fixed;
    padding: 12px;
    border-style: solid;
    border-width: 1px;
    margin: 5px;
    min-width: 68px; /* 96px - padding - border */
    max-width: 404; /* 432px - padding - border */
    min-height: 16px; /* 44px - padding - border */
    max-height: 492px; /* 520px - padding - border */
    width: auto;
    height: auto;
    word-wrap: break-word;
    overflow: auto;
    .win-type-body();
}

.win-flyout.win-leftalign {
    margin-left: 0;
}

.win-flyout.win-rightalign {
    margin-right: 0;
}

.win-flyout.win-scrolls {
    overflow: auto;
}

/*
Menu control.
*/
.win-menu {
    padding: 0;
    line-height: 33px;
    text-align: left; /* Set explicitly in case our parent has different alignment, like appbar overflow. */
    min-height: 46px; /* 44px -  2px in border = 46px */
    max-height: ~"calc(100% - 26px)";
    max-width: none;
}

.win-menu {
    /* Set explicitly in case our parent has different alignment, like appbar overflow. */
    .RTL({
        text-align: right;
    });
}

/*
Menu commands.
*/
.win-menu button.win-command {
    display: block;
    padding: 10px 20px 12px 20px;
    min-height: 44px;
    margin-left: 0;
    margin-right: 0;
    float: none;
    text-align: left;
    width: 100%;
    .win-type-body();
}

.win-menu button.win-command {
    .RTL({
        text-align: right;
    });
}

.win-menu button.win-command:focus {
    outline: none;
}

.win-menu hr.win-command {
    display: block;
    height: 1px;
    width: auto;
    border: 0;
    padding: 0;
    margin: 9px 20px 10px 20px;
}

/*
Menu toggle buttons.
*/
.win-menu-toggle button.win-command::before {
    font-family: "Segoe UI Symbol", "Symbols";
    content: "\E0E7";
    visibility: hidden;
    padding-left: 0px;
    padding-right: 12px;
}

.win-menu-toggle button[aria-checked=true].win-command::before {
    /* Display a checkbox if aria-checked is set */
    visibility: visible;
}

.win-menu-toggle button.win-command {
    .RTL({
        &::before {
            padding-right: 0;
            padding-left: 12px;
            float: right;
        }
    });
}

/*
Grippers in touch selection do not dissapear when focus moves to an element outside of the selection range and they are always drawn on a layer above all HTML elemements.
When an _Overlay derived control such as AppBar/Flyout/Menu/SettingsFlyout is invoked and steals focus, if that _Overlay is laid out on top of the elements in the touch selection,
the grippers can still be seen over the _Overlay and its contents. However, all grippers any where in the document will be hidden whenever the current active element has or inherits
the style "-ms-touch-select: none;"
*/
.win-overlay {
    -ms-touch-select: none;
}

/* For input elements we filter type using the :not selector to capture any unrecognized user specified types which would just default to the form and function of a textbox*/
.win-overlay input:not([type="file"]),
.win-overlay input:not([type="radio"]),
.win-overlay input:not([type="checkbox"]),
.win-overlay input:not([type="button"]),
.win-overlay input:not([type="range"]),
.win-overlay input:not([type="image"]),
.win-overlay input:not([type="reset"]),
.win-overlay input:not([type="hidden"]),
.win-overlay input:not([type="submit"]),
.win-overlay textarea,
.win-overlay [contenteditable=true] {
    -ms-touch-select: grippers;
}

/* Singleton element maintained by _Overlay, used for getting accurate floating point measurements of the total size of the visual viewport.
    Floating point is necesary in high DPI resolutions. */
.win-visualviewport-space {
    position: fixed;
    position: -ms-device-fixed;
    height: 100%;
    width: 100%;
    visibility: hidden;
}

/*
Settings Pane
*/
.win-settingsflyout {
    z-index: 1004; /* above appbar and below flyouts */
    border-left: 1px solid;
    position: fixed;
    top: 0;
    right: 0;
    height: 100%;
    width: 319px; /* 320px - border (1px) */
}

.win-settingsflyout {
    .RTL({
        border-left: none;
        border-right: 1px solid;
    });
}

.win-settingsflyout.win-wide { /* .win-wide is deprecated in Windows 8.1 */
    width: 645px; /* 646px - border (1px) */
}

.win-settingsflyout .win-header {
    padding-left: 40px;
    padding-right: 40px;
    padding-top: 32px;
    height: 48px;
}
/* Settings back button is slightly smaller. */
.win-settingsflyout .win-backbutton {
    position: absolute;
    width: 30px;
    height: 30px;
    font-size: 8pt;
    line-height: 26px;
    margin-top: 3px;
}

.win-settingsflyout .win-header .win-label {
    display: inline-block;
    padding-left: 40px;
    font-size: 20pt;
    line-height: 33px;
}

.win-settingsflyout .win-content {
    overflow: auto;
    padding-left: 12px;
    padding-right: 12px;
    padding-top: 33px;
    height: ~"calc(100% - 112px)";
}

.win-settingsflyout .win-label {
    .win-type-subtitle();
}

.win-settingsflyout {
    .RTL({
        right: auto;
        left: 0;
        border-left: none;
        border-right: 1px solid;
    });
}

.win-settingsflyout .win-header .win-label {
    .RTL({
        padding-right: 40px;
        padding-left: 0;
    });
}

.win-settingsflyout .win-content .win-settings-section {
    padding-top: 0;
    padding-bottom: 39px;
}

.win-settingsflyout .win-content .win-settings-section p {
    margin: 0;
    padding-top: 0;
    padding-bottom: 25px;
}

.win-settingsflyout .win-content .win-settings-section a {
    margin: 0;
    padding-top: 0;
    padding-bottom: 25px;
    display: inline-block;
}

.win-settingsflyout .win-content .win-settings-section {
    margin: 0;
    padding-top: 0;
    padding-bottom: 20px;
}

.win-settingsflyout .win-content .win-settings-section label {
    display: block;
    padding-bottom: 7px;
}

.win-settingsflyout .win-content .win-settings-section button,
.win-settingsflyout .win-content .win-settings-section select,
.win-settingsflyout .win-content .win-settings-section input[type=button],
.win-settingsflyout .win-content .win-settings-section input[type=text] {
    margin-bottom: 25px;
    margin-left: 0;
    margin-right: 20px;
}

.win-settingsflyout .win-content .win-settings-section input[type=radio] {
    margin-top: 0;
    margin-bottom: 0;
    padding-bottom: 15px;
}

.win-settingsflyout .win-content .win-settings-section button,
.win-settingsflyout .win-content .win-settings-section select,
.win-settingsflyout .win-content .win-settings-section input[type=text],
.win-settingsflyout .win-content .win-settings-section input[type=button] {
    .RTL({
        margin-bottom: 25px;
        margin-left: 20px;
        margin-right: 0;
    });
}

/*Flyout control animations*/
@keyframes WinJS-showFlyoutTop               { from { transform: translateY(50px); } to { transform: none; } }
@keyframes WinJS-showFlyoutBottom            { from { transform: translateY(-50px); } to { transform: none; } }
@keyframes WinJS-showFlyoutLeft              { from { transform: translateX(50px); } to { transform: none; } }
@keyframes WinJS-showFlyoutRight             { from { transform: translateX(-50px); } to { transform: none; } }
@-webkit-keyframes -webkit-WinJS-showFlyoutTop               { from { -webkit-transform: translateY(50px); } to { -webkit-transform: none; } }
@-webkit-keyframes -webkit-WinJS-showFlyoutBottom            { from { -webkit-transform: translateY(-50px); } to { -webkit-transform: none; } }
@-webkit-keyframes -webkit-WinJS-showFlyoutLeft              { from { -webkit-transform: translateX(50px); } to { -webkit-transform: none; } }
@-webkit-keyframes -webkit-WinJS-showFlyoutRight             { from { -webkit-transform: translateX(-50px); } to { -webkit-transform: none; } }
